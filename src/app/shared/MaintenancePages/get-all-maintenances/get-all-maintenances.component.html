
<form class="bg-white dark:bg-[#2a2b2f] rounded-xl shadow-xl p-4 space-y-6  my-5"
    [formGroup]="form">

<!-- Basic Filters -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  <div>
    <label class="text-sm text-gray-600 font-medium block mb-1">Employee First Name</label>
    <input type="text" formControlName="empFirstName" placeholder="John"
            class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                  rounded-lg border border-gray-300 dark:border-gray-600
                  focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                  focus:outline-none shadow-sm transition-all duration-200">
  </div>

  <div>
    <label class="text-sm text-gray-600 font-medium block mb-1">Employee Last Name</label>
    <input type="text" formControlName="empLastName" placeholder="Doe"
            class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                  rounded-lg border border-gray-300 dark:border-gray-600
                  focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                  focus:outline-none shadow-sm transition-all duration-200">
  </div>

  <div>
    <label class="text-sm text-gray-600 font-medium block mb-1">Father's Name</label>
    <input type="text" formControlName="empFatherName" placeholder="Michael"
            class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                  rounded-lg border border-gray-300 dark:border-gray-600
                  focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                  focus:outline-none shadow-sm transition-all duration-200">
  </div>
</div>

<!-- Animated Extra Filters -->
<div [@expandCollapse]="showAllFilters ? 'expanded' : 'collapsed'"
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 transition-all duration-300 ease-in-out">
  
  
      <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Vehicle Brand</label>
      <input type="text" formControlName="vehBrand" placeholder="Toyota"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>

    <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Vehicle Model</label>
      <input type="text" formControlName="vehModel" placeholder="Corolla"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>

    <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Service Name</label>
      <input type="text" formControlName="servName" placeholder="Oil Change"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>

    <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Customer First Name</label>
      <input type="text" formControlName="custFirstName" placeholder="Sarah"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>

    <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Customer Last Name</label>
      <input type="text" formControlName="custLastName" placeholder="John"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>

    <div>
      <label class="text-sm text-gray-600 font-medium block mb-1">Customer Father Name</label>
      <input type="text" formControlName="custFatherName" placeholder="Doe"
              class="w-full px-3 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-[#2a2b2f]
                    rounded-lg border border-gray-300 dark:border-gray-600
                    focus:border-[#6B7C9D] focus:ring-3 focus:ring-[#6B7C9D]
                    focus:outline-none shadow-sm transition-all duration-200">
    </div>
</div>

<!-- Action Buttons -->
<div class="flex justify-end gap-4">
  <button type="button"
          (click)="toggleFilters()"
          class="text-sm text-blue-600 hover:underline focus:outline-none">
    {{ showAllFilters ? 'Show Less' : 'Show More' }}
  </button>
  
  <button (click)="addMaintenance()"
  class="relative overflow-hidden px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1"
  >
  <i class="bi bi-plus-circle mr-2"></i> Add New Maintenance
  </button>
  
  <button type="submit"
          (click)="submit()"
          class="relative overflow-hidden px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1"
          >
          <i class="bi bi-check mr-2 "></i> Submit
    </button>
</div>
</form>

<div class="overflow-x-auto max-h-100 border-[0.5px] border-gray-500 rounded-lg">
  <table class="min-w-full divide-y divide-gray-200 bg-white dark:bg-[#2a2b2f]">
    <!-- Header -->
    <thead>
      <tr class="bg-[#6B7C9D] text-black dark:bg-[#131212] dark:text-white text-center text-sm font-semibold">
        <th class="p-3">#</th>

        <th *ngFor="let column of columns" class="p-3">
          {{ column.header }}
        </th>

        <th class="p-3">Status</th>
        
        <th class="p-3">Action</th>
      </tr>
    </thead>
    <!-- Body -->
    <tbody>
      <tr
        *ngFor="let row of maintenances; let i = index"
        class="text-center border-b dark:border-gray-700 text-sm text-gray-700 dark:text-white hover:bg-blue-100  transition-all duration-200"
      >
        <td class="p-3">{{ i + 1 }}</td>

        <td *ngFor="let column of columns" class="p-3">
          {{ getNestedValue(row, column.key) }}
        </td>

        <td class="p-3 flex justify-center items-center">
          <span
            class="inline-block w-3 h-3 rounded-full"
            [ngClass]="{
              'bg-green-500': row.isCompleted,
              'bg-orange-500': row.isPending && !row.isCompleted && !row.isCanceled,
              'bg-red-500': row.isCanceled,
              'bg-gray-400': !row.isCompleted && !row.isPending && !row.isCanceled
            }"
          ></span>

        </td>
        <td class=" p-3">
          <div class="flex flex-1 justify-center  gap-4">
            <button (click)="openMainteancePopup(row)">
              <i class="bi bi-eye-fill"></i>
            </button>
            <button (click)="openUpdateMainteancePopup(row)">
              <i class="bi bi-pen-fill"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
@if (showViewMaintenancePopup) {
  <app-maintenance-form 
  [maintenance]="selectedMaintenance!"
  (closeForm) = "showViewMaintenancePopup = false"
  ></app-maintenance-form>
}
@if (showUpdateMaintenancePopup) {
  <app-update-maintenance-form
  [maintenance]="selectedMaintenance!"
  (refresh) ="submit()"  
  (closeForm) = "showUpdateMaintenancePopup = false"
  ></app-update-maintenance-form>
}
